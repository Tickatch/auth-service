# Auth Service Error Messages 한글 매핑

## AuthErrorCode

### 조회 (404)

| 코드 | 메시지 |
|------|--------|
| `AUTH_NOT_FOUND` | 인증 정보를 찾을 수 없습니다. |
| `PROVIDER_NOT_FOUND` | 연동된 소셜 계정을 찾을 수 없습니다. (제공자: {0}) |

### 검증 - 회원가입 (400)

| 코드 | 메시지 |
|------|--------|
| `INVALID_EMAIL` | 이메일 형식이 올바르지 않습니다. |
| `INVALID_PASSWORD` | 비밀번호에 허용되지 않은 문자가 포함되어 있습니다. (허용 특수문자: !@#$%^*()_+-=.,?) |
| `INVALID_USER_TYPE` | 사용자 유형이 올바르지 않습니다. |
| `DUPLICATE_EMAIL` | 이미 가입된 이메일입니다. (유형: {0}) |

### 검증 - 비밀번호 (400)

| 코드 | 메시지 |
|------|--------|
| `PASSWORD_MISMATCH` | 현재 비밀번호가 일치하지 않습니다. |
| `SAME_AS_OLD_PASSWORD` | 새 비밀번호는 기존 비밀번호와 달라야 합니다. |
| `PASSWORD_TOO_SHORT` | 비밀번호는 최소 8자 이상이어야 합니다. |
| `PASSWORD_TOO_WEAK` | 비밀번호는 영문, 숫자, 특수문자를 모두 포함해야 합니다. |

### 검증 - 소셜 로그인 (400)

| 코드 | 메시지 |
|------|--------|
| `INVALID_PROVIDER` | 지원하지 않는 소셜 로그인 제공자입니다. (제공자: {0}) |
| `INVALID_OAUTH_CODE` | 유효하지 않은 인증 코드입니다. |
| `PROVIDER_ALREADY_CONNECTED` | 이미 연동된 소셜 계정입니다. (제공자: {0}) |
| `OAUTH_NOT_ALLOWED_FOR_USER_TYPE` | 소셜 로그인은 일반 고객만 사용 가능합니다. (사용자 유형: {0}) |

### 인증 실패 (401)

| 코드 | 메시지 |
|------|--------|
| `INVALID_CREDENTIALS` | 이메일 또는 비밀번호가 일치하지 않습니다. |
| `AUTHENTICATION_FAILED` | 인증에 실패했습니다. |

### 권한 없음 (403)

| 코드 | 메시지 |
|------|--------|
| `ACCOUNT_LOCKED` | 계정이 잠금 상태입니다. 비밀번호 초기화를 진행해주세요. |
| `ACCOUNT_WITHDRAWN` | 탈퇴한 계정입니다. |
| `ACCESS_DENIED` | 접근 권한이 없습니다. |

### 비즈니스 규칙 (422)

| 코드 | 메시지 |
|------|--------|
| `LOGIN_FAILED_LIMIT_EXCEEDED` | 로그인 실패 횟수 초과로 계정이 잠금되었습니다. (실패 횟수: {0}) |
| `CANNOT_DISCONNECT_LAST_PROVIDER` | 마지막 소셜 로그인 연동은 해제할 수 없습니다. 비밀번호를 먼저 설정해주세요. |
| `ALREADY_WITHDRAWN` | 이미 탈퇴한 계정입니다. |

### 외부 서비스 (503)

| 코드 | 메시지 |
|------|--------|
| `OAUTH_SERVER_ERROR` | 소셜 로그인 서버에 문제가 발생했습니다. 잠시 후 다시 시도해주세요. (제공자: {0}) |
| `EVENT_PUBLISH_FAILED` | 이벤트 발행에 실패했습니다. (인증 ID: {0}) |

---

## TokenErrorCode

### 조회 (404)

| 코드 | 메시지 |
|------|--------|
| `REFRESH_TOKEN_NOT_FOUND` | 리프레시 토큰을 찾을 수 없습니다. |

### 검증 (400)

| 코드 | 메시지 |
|------|--------|
| `INVALID_TOKEN` | 유효하지 않은 토큰입니다. |
| `INVALID_REFRESH_TOKEN` | 유효하지 않은 리프레시 토큰입니다. |
| `INVALID_TOKEN_FORMAT` | 토큰 형식이 올바르지 않습니다. |

### 만료 (401)

| 코드 | 메시지 |
|------|--------|
| `TOKEN_EXPIRED` | 토큰이 만료되었습니다. 다시 로그인해주세요. |
| `REFRESH_TOKEN_EXPIRED` | 리프레시 토큰이 만료되었습니다. 다시 로그인해주세요. |

### 비즈니스 규칙 (422)

| 코드 | 메시지 |
|------|--------|
| `TOKEN_ALREADY_REVOKED` | 이미 폐기된 토큰입니다. |
| `TOKEN_REUSE_DETECTED` | 토큰 재사용이 감지되었습니다. 보안을 위해 모든 세션이 종료되었습니다. |

---

## 정책 참고

### 비밀번호 정책

| 항목 | 규칙 |
|------|------|
| 최소 길이 | 8자 이상 |
| 문자 조합 | 영문, 숫자, 특수문자 3가지 모두 필수 |
| 허용 특수문자 | `!@#$%^*()_+-=.,?` |
| 금지 문자 | `'"<>&;\|`$\{}[]:` (보안 위험 문자) |

### 토큰 정책

| 토큰 | 만료 시간 | 비고 |
|------|----------|------|
| Access Token | 5분 | 탈취 시 피해 최소화 |
| Refresh Token (기본) | 1시간 | 로그인 유지 미선택 시 |
| Refresh Token (로그인 유지) | 30일 | 로그인 유지 선택 시 |

### 계정 잠금 정책

| 항목 | 규칙 |
|------|------|
| 잠금 조건 | 로그인 실패 5회 초과 |
| 해제 방법 | 비밀번호 초기화 또는 관리자 해제 |

### 토큰 Rotation 정책

| 항목 | 규칙 |
|------|------|
| Rotation | Refresh Token 1회 사용 후 교체 |
| 재사용 감지 | 이미 사용된 토큰 재사용 시 모든 토큰 폐기 |

### 소셜 로그인 정책

| 사용자 유형 | 소셜 로그인 | 비고 |
|------------|-----------|------|
| CUSTOMER | ✅ 허용 | 일반 고객, 편의성 중요 |
| SELLER | ❌ 불가 | 사업자 인증 필요, 보안 강화 |
| ADMIN | ❌ 불가 | 내부 시스템, 최고 보안 필요 |